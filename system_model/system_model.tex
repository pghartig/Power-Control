
\documentclass[12pt]{article}
\usepackage{fullpage,graphicx,psfrag,amsmath,amsfonts,verbatim}
\usepackage[small,bf]{caption}

\input defs.tex

\bibliographystyle{alpha}

\title{Power Allocation in Heterogeneous Networks with Multiple Antenna }
\author{Peter Hartig}


\newtheorem{theorem}{Theorem}


\begin{document}
\maketitle


\begin{abstract}
This game considers a wireless communications network which includes both macro cell and femto cell users. In order to allow for uncoordinated usage of femto cells within the network, the base stations of femto cells must ensure that the users served by macro cells intercept an acceptable amount of interference during transmission. The strategy for transmission across all such femto cells in a network is investigated here in a game theoretic context. 

\end{abstract}

\newpage
\tableofcontents
\newpage

\section{Game and System Setup}

\subsection{Game Elements}

\subsubsection{Players: Femto Cell Base Stations}


Individual femto cell base stations (FC-BS) are the players of this game.
\\
Femtro Cells are characterized by the following parameters
\begin{itemize}
\item 
	Each FC-BS  $f \in \{1 ... F\}$ is considered to have a number of antennas $T_f$ with which to transmit to $K_f$ femto cell users.
\\
\item 
	FC-BSs with multiple antennas ($T_f >1$) can beamform their transmission using the precoding 	
	matrix $\mathbf{U_{\mathrm{f}}} \in \mathbb{C}_{T_f \times K_f}$ such that the transmitted 		
	signal is $\mathbf{s_{\mathrm{f}
	}}= \mathbf{U_{\mathrm{f}}}\mathbf{x_{\mathrm{f}}}$. Here $\mathbf{x_{\mathrm{f}}}$ is the 		
	normalized vector of symbols for users of FC-BS $f$ (i.e. $\mathbf{E[\|\mathbf{x_{\mathrm{f}}}	
	\|_2^2]} \; f \in \{1 ... F\}$).
\\
\item 
	FC-BS $f$ has power constraint $trace(\mathbf{U_f^H}\mathbf{U_f}) \leq P^{Total}_{f} $.
\\
\item
	 FC-BSs are assumed to be spaced far apart in distance. Therefore, FC-BS $f$ can be modeled as 
	 causing no interference to the users of FC-BS $j \in \{1 ... F\}\backslash f$
\item 
	FC-BSs are assumed to have a utility function $U_f()$ based upon the quality of service 		
	provided to its users. TODO (Discuss Reasonable functions)
\\
\item 
	FC-BS $f$ is assumed to know the downlink channel ($\mathbf{H_f}$) from its transmission 		
	antennas to all served users.
% TODO(Simulate degradation with incomplete CSI solution?)
\\
\end{itemize}

\subsubsection{Macro Cell Users}

\begin{itemize}
\item 
	Macro Cell user $m \in \{1 ... M\}$ experiences receiver interference due to transmission by
	FC-	BSs. These macro-cell users have limits to the amount of interference they may tolerate 
	$\sum^F_{f=1} \mathbf{\tilde{h_{\mathrm{m,f}}^T}}  \mathbf{U_{\mathrm{f}}} 						
	\mathbf{U_{\mathrm{f}}^{\mathrm{H}}} \mathbf{\tilde{h_{\mathrm{m,f}}^*}} \leq I^{Threshold}		
	_{\mathrm{m}} $.

\item 
	FC-BS $f$ is assumed to know the downlink channel ($\tilde{\mathbf{H}_{\mathrm{f}}}$) from its
	transmission antennas to all macro-cells with which it interferes.
\\
\end{itemize}

\subsubsection{Femtro Cell Users}
\begin{itemize}


%\item TODO Decide if there should be minimum rate constraints for femto cell users in case (Look back at later in case some users are beam-formed out of the transmission). Check if this constraint will disrupt solution.
%\\

\item Users of FC-BS $f$ have SINR:
	\begin{equation*}
	\gamma_{\mathrm{f,i}} = \frac{|\mathbf{h^H_{\mathrm{f,i}}u_{\mathrm{f,i}}}|^2}
	{\sigma^2_{noise}   + \sum_{\mathrm{\tilde{f}}\neq f} \sum_{\mathrm{u=1}
	}^{K_{\mathrm{\tilde{f}}}}
	|\mathbf{h^H_{\mathrm{\tilde{f},u}}u_{\mathrm{f,i}}}|^2
	 + \sum_{\mathrm{\tilde{k}\neq i}}
	  |\mathbf{h^H_{\mathrm{f,\tilde{k}}}u_{\mathrm{f,\tilde{k}}}}|^2}
	  \; \mathrm{i \in \{1 ... K_f\}}\end{equation*}
\\
with AWGN $\sim \mathcal{N}(0,\sigma^2_n)$
\\

Assuming negligible inter-cell interference, this reduces to
	\begin{equation*}
	\gamma_{\mathrm{f,i}} = \frac{|\mathbf{h^H_{\mathrm{f,i}}u_{\mathrm{f,i}}}|^2}
	{\sigma^2_{noise} 
	 + \sum_{\mathrm{\tilde{k}\neq i}}
	  |\mathbf{h^H_{\mathrm{f,\tilde{k}}}u_{\mathrm{f,\tilde{k}}}}|^2}
	  \; \mathrm{i \in \{1 ... K_f\}}
	\end{equation*}
\\

%This further simplifies assuming that users use a zero-forcing beam-former
%
%\begin{equation}\label{zf_snr}
%\gamma_{\mathrm{f,i}} = \frac{|\mathbf{h^H_{\mathrm{f,i}}u_{\mathrm{f,i}}}|^2}
%{\sigma^2_{noise}  
%}
%\end{equation}
%\\

\end{itemize}


%\subsection{Variations of Game Setup}
%
%\subsubsection{Case: $T_f \geq M + K_f$}
%FC-BSs could potentially zero-beam-form towards all macro users. However, as base stations have power constraints, it may be beneficial to cause certain amounts of interference. 
%
%\subsubsection{Case: $K_f \leq T_f < M + K_f$}
%FC-BSs can send unique signals to all users but does not have sufficient DOF to zero-beam-form for all macro users.


\subsection{General Optimization Problem}

Each player $f$ attempts to maximize utility function $U_f()$ while playing a strategy that falls in the region constrained by the interference constraints imposed by the macro cell users.
\\

The player optimization problem of player $f$ can be written as:

	
	\begin{subequations}
	\label{eq:optim}
	\begin{align}
	    \underset{\mathbf{U_{\mathrm{f}}} }{\text{minimize}}
	    & - \sum_{\mathrm{i=1}}^{\mathrm{K_f}}
    	U_{\mathrm{f,i}}(\gamma_{\mathrm{f,i}})\label{player_opt} \\
	    \text{subject to}  &
	    \sum^F_{f=1}\mathbf{\tilde{h_{m,f}^T}}  \mathbf{U_f}  \mathbf{U_f^H}
		\mathbf{\tilde{h_{m,f}^*}} \leq I^{\mathrm{Threshold}}_{m} & m \in \{1 ...M\} 
		\label{interference_const}\\
        & trace(\mathbf{U_f^H}\mathbf{U_f}) \leq P^{Total}_{f} \label{power_const}\\
        & \langle \mathbf{h_{f,j}}\mathbf{u_{f,i}} \rangle =0\ \; \forall j \in \{1... K_f\}				\backslash i &\forall i \in \{1 ... K_f\} \label{zf_const}
	\end{align}
	\end{subequations}

	
Note that over the feasible region of this problem, the SINR of femto cell users reduces to due to  \eqref{zf_const}

	\begin{equation}\label{zf_snr}
	\gamma_{\mathrm{f,i}} = \frac{|\mathbf{h^H_{\mathrm{f,i}}u_{\mathrm{f,i}}}|^2}
	{\sigma^2_{noise}  
	}
	\end{equation}

\section{Solving the Game}
\subsection{Player Utility Functions}

Say $U_f() $ is the sum of all capacities for femto cell users of FC-BS $f$ 
\begin{displaymath}
U_f(\mathbf{U_f}) = \sum^{K_f}_{i=1} log(1+\gamma_{\mathrm{f,i}})
\end{displaymath}

\subsection{Verify of Player Optimization Problem}

Conditions for Convex Problem:

\begin{enumerate}
\item Utility function is concave in its argument 
\begin{itemize}
\item 
Constraint \eqref{zf_const}  ensures that $\gamma_{\mathrm{f,i}}$ takes the form of \eqref{zf_snr} and  as log() is concave is the argument (SINR). SINR increases with square of absolute value. (The resulting function has a negative 2nd derivative)
\end{itemize}

\item
Constraints form convex, closed and bounded set. TODO show closed and boundedness of set

\begin{itemize}

\item
	Constaint \eqref{interference_const} contains $M$ quadratic constraints on $\mathbf{U_f}$ and 
	can be rewritten as 

\begin{gather*}
	\sum_{f=1}^F
	trace(\mathbf{U_f^H} \mathbf{\tilde{h}_{m,f}} \mathbf{\tilde{h}_{m,f}^H} \mathbf{U_f} )\leq 
	I^{Threshold}_{m}.
\end{gather*}
This can be decomposed into \textit{independent} components 
	\begin{gather*}
	\sum_{f=1}^F
	\sum_{i=1}^{f_i}
	\mathbf{u_{\mathrm{f,i}}^H} \mathbf{\tilde{h}_{m,f}} \mathbf{\tilde{h}_{m,f}^H} 
	\mathbf{u_{\mathrm{f,i}}} \leq I^{Threshold}_{m}
	\end{gather*}
In which the term $ \mathbf{\tilde{h}_{m,f}} \mathbf{\tilde{h}_{m,f}^H}$ is always a positive semi-definite matrix, this is a convex set according to 
\cite[p.8,9]{BoV:04}. This is essentially high dimensional ellipsoid.



\item \
	\eqref{power_const} can be decomposed as above into
	\begin{gather*}
		\sum_{i=1}^{K_f}\mathbf{u_{\mathrm{f,i}}^H} \mathbf{I} 		
		\mathbf{u_{\mathrm{f,i}}} \leq  P^{Total}_{f}
	\end{gather*}
	in which $\mathbf{I}$ is always positive definite and 			
	therefore the constraint is strictly convex by the same 		
	reasons as \eqref{interference_const}.
\end{itemize}

\item
	Constaint \eqref{zf_const} is an affine constraint. 
%Note that affine constaints to not have to satisfy Slater's condition
	\begin{itemize}
	\item
		\begin{gather*}
		\langle \mathbf{h_{\mathrm{f,j}}}\mathbf{u_{\mathrm{f,i}}} \rangle =0
		\end{gather*}
	\end{itemize}
\end{enumerate}



\subsection{Finding Nash Equilibrium}

\begin{enumerate}
\item \textbf{Existence of NE:} Given that the player optimization problem is convex, this is an n-person concave game and therefore a NE exists \cite{rosen1964existence}. 
\item \textbf{Uniqueness of NE:} Diagonally Strict concavity is a sufficient condition for uniqueness of NNE in n-person concave game \cite{rosen1964existence}.
\begin{itemize}
\item\eqref{utility} has negative second derivative w.r.t the argument and contains no intra-cell interference and therefore is negative definite. Which is sufficient for being diagonally strictly concave
\cite[Thm6]{rosen1964existence} ( Thm 6)

\item \textbf{Potential Function:} The proposed potential function is 

\begin{gather*} \label{Potential_Function}
\Phi() = \sum_{f = 1}^{F} U_f() 
\end{gather*}


As the utility functions of individual players $f$ do not share any common variables,  \label{Potential_Function} will have the same derivative as individual $U_f()$ with respect to $\mathbf{U_{f,i}} $. 


\end{itemize}

\end{enumerate}

\subsection{Setup as a Potential Game}
Assuming the NE is unique and the game admits a potential function $\Phi()$ then the solution to the potential function will be the unique NE of the original game if the potential function is also concave. 
The sum of the utility functions admits one such potential function and since the individual utility functions are independent of one another and individually concave (shown above) , the resulting potential function will also be concave. 
\\
\begin{theorem}\label{distributed}
If a game's potential function is strictly concave and the derivative of the function with respect to the individual players variables are independent of the other player variables, then there exists a distributed solution.
%\\\cite[~algodist]{ghosh2015normalized}
\end{theorem}
\subsubsection{Central Optimization Problem Resulting from Proposed Potential Game}

\begin{gather}\label{potential_game}
\mathrm{argmax}_{U_{\mathrm{1}}.. U_{\mathrm{F}}}
\;
\sum_{f=1}^F
\sum_{i=1}^{f_i}
log(1+\frac{p_{ \mathrm{f,i}}|\mathbf{h^H_{\mathrm{fi}}u_{ \mathrm{fi}}}|^2}{\sigma^2_{ \mathrm{noise}} })
\\
\mathrm{s.t}
\\
\sum_{f=1}^F
\sum_{i=1}^{f_i}
\mathbf{u_{ \mathrm{f,i}}^H} \mathbf{\tilde{h_{m,f}}} \mathbf{\tilde{h_{m,f}^H}} \mathbf{u_{\mathrm{f,i}}} \leq I^{Threshold}_{m} \;  \mathrm{m} \in  \mathrm{\{1 ... M\}}
\\
\sum_{i=1}^{K_f}\mathbf{u_{f,i}^H} \mathbf{I} \mathbf{u_{\mathrm{f,i}}} \leq  P^{Total}_{f}
\; \mathrm{f} \in \mathrm{\{1 ... F\}}
\\
\\
\langle \mathbf{h_{\mathrm{f,j}}}\mathbf{u_{\mathrm{f,i}}} \rangle =0\ \; \forall \; \mathrm{j \in \{1 ... K_f\}\backslash i \;\; 
}
\forall \;\;\mathrm{ i \in \{1 ... K_f\}}
\end{gather}



\subsection{Distributed Solution to the Game}
\subsubsection{Central Problem Resulting from Potential Game}
As described in \cite[p.~8,9]{boyd2011distributed}, the dual ascent method can be used to find a distributed solution to this problem using the Lagrangian of \eqref{potential_game}
\\
\begin{multline}
L(\mathbf{U,\lambda}) = 
\;
\sum_{f=1}^F
\sum_{i=1}^{f_i}
log(1+\frac{p_{ \mathrm{f,i}}|\mathbf{h^H_{\mathrm{fi}}u_{ \mathrm{fi}}}|^2}{\sigma^2_{ \mathrm{noise}} })
+
\sum_{\mathrm{f=1}}^M \lambda_{\mathrm{m}}
(\sum_{\mathrm{f=1}}^F
\sum_{\mathrm{i=1}}^{f_i}
\mathbf{u_{ \mathrm{f,i}}^H} \mathbf{\tilde{h_{m,f}}} \mathbf{\tilde{h_{m,f}^H}} \mathbf{u_{\mathrm{f,i}}} - I^{Threshold}_{m} )
\\
+ 
\lambda_{\mathrm{f}}(
\sum_{i=1}^{K_f}\mathbf{u_{f,i}^H} \mathbf{I} \mathbf{u_{\mathrm{f,i}}} -  P^{Total}_{f})
+
\sum_{f=1}^F
\sum_{i=1}^{f_i}
\nu_{\mathrm{f,k}}(\mathbf{h^T_{\mathrm{f,j}}}\mathbf{u_{\mathrm{f,i}}})
\end{multline}

in which individual FC-BSs first optimize individually
\begin{enumerate}
\item 
\begin{gather}
\mathbf{U^{\mathrm{k+1}}_{\mathrm{f}}} =\mathrm{argmax}_{\mathbf{U_{\mathrm{f}}}} \; L(\mathbf{U,\lambda})
\end{gather}
and then macro stations will take a gradient ascent step using a 
predetermined $\alpha^{\mathrm{k}}$
\item 
\begin{gather}
\lambda_{\mathrm{m}}^{\mathrm{k+1}} = 
\lambda_{\mathrm{m}}^{\mathrm{k}}
+
\alpha^{\mathrm{k}}*
(\frac{\partial L(\mathbf{\mathbf{U_{\mathrm{f}}},\lambda}) )}{\partial\lambda_{\mathrm{m}}})
\end{gather}
in which $\mathbf{U^{\mathrm{k}}_{\mathrm{f}}} = [\mathbf{U^{\mathrm{k}}_{\mathrm{1}}}...\mathbf{U^{\mathrm{k}}_{\mathrm{F}}}]$

\end{enumerate} 

TODO show proof convergence conditions of this algorithm
\newpage
\bibliography{system_model_bib}

\end{document}
